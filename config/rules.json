{
  "rules": [
    {
      "rule_id": "RULE-001",
      "name": "Brute Force Login Attempt",
      "description": "Detects multiple failed login attempts from the same source, indicating potential brute force attack",
      "pattern": "(failed|invalid|bad).*(password|login|auth)",
      "field": "message",
      "threshold": 5,
      "time_window": 300,
      "severity": 8,
      "enabled": true,
      "tags": ["authentication", "brute-force"],
      "group_by": "source_ip"
    },
    {
      "rule_id": "RULE-002",
      "name": "Port Scan Detection",
      "description": "Detects connection attempts to multiple ports from a single source",
      "pattern": "(connection refused|port|scan|probe)",
      "field": "message",
      "threshold": 10,
      "time_window": 60,
      "severity": 7,
      "enabled": true,
      "tags": ["reconnaissance", "network"],
      "group_by": "source_ip"
    },
    {
      "rule_id": "RULE-003",
      "name": "Privilege Escalation Attempt",
      "description": "Detects attempts to gain elevated privileges",
      "pattern": "(sudo|su |root|admin|privilege|escalat)",
      "field": "message",
      "threshold": 1,
      "time_window": 60,
      "severity": 9,
      "enabled": true,
      "tags": ["privilege-escalation", "critical"],
      "group_by": "user"
    },
    {
      "rule_id": "RULE-004",
      "name": "After-Hours Access",
      "description": "Detects login activity outside normal business hours",
      "pattern": "(login|session|authenticated)",
      "field": "message",
      "threshold": 1,
      "time_window": 3600,
      "severity": 4,
      "enabled": true,
      "tags": ["policy", "access-control"],
      "group_by": "user"
    },
    {
      "rule_id": "RULE-005",
      "name": "SSH Authentication Failure",
      "description": "Detects failed SSH authentication attempts",
      "pattern": "(sshd|ssh).*(failed|invalid|rejected)",
      "field": "message",
      "threshold": 3,
      "time_window": 60,
      "severity": 6,
      "enabled": true,
      "tags": ["ssh", "authentication"],
      "group_by": "source_ip"
    },
    {
      "rule_id": "RULE-006",
      "name": "Suspicious File Access",
      "description": "Detects access attempts to sensitive system files",
      "pattern": "(/etc/shadow|/etc/passwd|/etc/sudoers|\\.ssh/|private.*key)",
      "field": "message",
      "threshold": 1,
      "time_window": 300,
      "severity": 8,
      "enabled": true,
      "tags": ["file-access", "sensitive-data"],
      "group_by": "user"
    },
    {
      "rule_id": "RULE-007",
      "name": "Account Lockout",
      "description": "Detects account lockout events due to failed authentication",
      "pattern": "(locked|lockout|disabled|blocked).*account",
      "field": "message",
      "threshold": 1,
      "time_window": 300,
      "severity": 5,
      "enabled": true,
      "tags": ["authentication", "account"],
      "group_by": "user"
    },
    {
      "rule_id": "RULE-008",
      "name": "New Administrative Account",
      "description": "Detects creation of new accounts with administrative privileges",
      "pattern": "(new|created|added).*(admin|root|sudo|wheel)",
      "field": "message",
      "threshold": 1,
      "time_window": 3600,
      "severity": 9,
      "enabled": true,
      "tags": ["account-management", "critical"],
      "group_by": null
    },
    {
      "rule_id": "RULE-009",
      "name": "Critical Service Stopped",
      "description": "Detects when critical system services are stopped unexpectedly",
      "pattern": "(stopped|terminated|killed|shutdown).*(service|daemon|sshd|apache|nginx|mysql)",
      "field": "message",
      "threshold": 1,
      "time_window": 300,
      "severity": 7,
      "enabled": true,
      "tags": ["service", "availability"],
      "group_by": null
    },
    {
      "rule_id": "RULE-010",
      "name": "Large Data Transfer",
      "description": "Detects unusually large outbound data transfers",
      "pattern": "(transfer|upload|sent|outbound).*(large|MB|GB|bytes)",
      "field": "message",
      "threshold": 1,
      "time_window": 300,
      "severity": 6,
      "enabled": true,
      "tags": ["data-exfiltration", "network"],
      "group_by": "source_ip"
    },
    {
      "rule_id": "RULE-011",
      "name": "Multiple Login Locations",
      "description": "Detects same user logging in from multiple IP addresses",
      "pattern": "(accepted|successful|logged in)",
      "field": "message",
      "threshold": 3,
      "time_window": 300,
      "severity": 5,
      "enabled": true,
      "tags": ["authentication", "anomaly"],
      "group_by": "user"
    },
    {
      "rule_id": "RULE-012",
      "name": "Malware Signature Detected",
      "description": "Detects known malware patterns or signatures",
      "pattern": "(malware|virus|trojan|ransomware|backdoor|rootkit)",
      "field": "message",
      "threshold": 1,
      "time_window": 60,
      "severity": 10,
      "enabled": true,
      "tags": ["malware", "critical"],
      "group_by": null
    },
    {
      "rule_id": "RULE-013",
      "name": "Firewall Rule Modification",
      "description": "Detects changes to firewall rules or configurations",
      "pattern": "(firewall|iptables|ufw).*(changed|modified|added|deleted|rule)",
      "field": "message",
      "threshold": 1,
      "time_window": 300,
      "severity": 7,
      "enabled": true,
      "tags": ["configuration", "network"],
      "group_by": "user"
    },
    {
      "rule_id": "RULE-014",
      "name": "Database Access Anomaly",
      "description": "Detects unusual database access patterns",
      "pattern": "(mysql|postgres|mongodb|database).*(drop|truncate|delete from|select \\*)",
      "field": "message",
      "threshold": 3,
      "time_window": 60,
      "severity": 7,
      "enabled": true,
      "tags": ["database", "data-access"],
      "group_by": "user"
    },
    {
      "rule_id": "RULE-015",
      "name": "Command Injection Attempt",
      "description": "Detects potential command injection attacks",
      "pattern": "(;|\\||`|\\$\\(|&&).*(rm|cat|wget|curl|nc|bash)",
      "field": "message",
      "threshold": 1,
      "time_window": 60,
      "severity": 9,
      "enabled": true,
      "tags": ["injection", "attack"],
      "group_by": "source_ip"
    }
  ]
}
